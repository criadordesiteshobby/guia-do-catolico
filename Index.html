<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Portal do Cat√≥lico</title>
  <style>
    :root{
      --gold:#B8860B;
      --lime:#d9ff91;
      --bg:#fffdf5;
      --muted:#666;
      --card:#fff;
      --radius:12px;
    }
    *{box-sizing:border-box}
    body{font-family:Poppins,system-ui,Arial; margin:0; background:var(--bg); color:#222}
    header{background:linear-gradient(90deg,#fff,#f0c93d,#d9ff91); padding:18px; text-align:center; font-weight:700; font-size:1.6rem; box-shadow:0 4px 10px rgba(0,0,0,.06)}
    main{max-width:1000px;margin:28px auto;padding:16px}
    .grid{display:grid; grid-template-columns:360px 1fr; gap:18px}
    @media(max-width:920px){ .grid{grid-template-columns:1fr} }
    .card{background:var(--card); border-radius:var(--radius); padding:16px; box-shadow:0 6px 20px rgba(0,0,0,.04)}
    h2{color:var(--gold); margin:0 0 12px}
    input{width:100%; padding:10px;border-radius:8px;border:1px solid rgba(0,0,0,.08); margin:8px 0}
    button{background:var(--gold); color:white; border:none; padding:10px 14px;border-radius:10px; cursor:pointer; font-weight:700}
    button.ghost{background:transparent;color:var(--gold);border:2px solid rgba(0,0,0,.06)}
    .muted{color:var(--muted)}
    .center{text-align:center}
    .flag{font-size:2.6rem}
    footer{padding:14px;text-align:center;color:var(--muted);margin-top:18px}
    .small{font-size:.9rem;color:var(--muted)}
  </style>
</head>
<body>
  <header>‚úùÔ∏è Portal do Cat√≥lico ‚úùÔ∏è</header>

  <main>
    <div class="grid">
      <!-- SIDEBAR: Login / User -->
      <div class="card" id="sidebar">
        <!-- Auth block -->
        <div id="authBlock">
          <h2>Login / Cadastro</h2>
          <input id="email" type="email" placeholder="Email" autocomplete="username" />
          <input id="password" type="password" placeholder="Senha (min 6 caracteres)" autocomplete="current-password" />
          <div style="display:flex;gap:8px;margin-top:8px">
            <button id="btnRegister">Cadastrar</button>
            <button id="btnLogin" class="ghost">Entrar</button>
          </div>
          <p id="authMsg" class="small muted"></p>
        </div>

        <!-- User block (aparece ap√≥s login) -->
        <div id="userBlock" style="display:none">
          <h2 id="welcomeTitle">Bem-vindo(a)</h2>
          <p class="small muted" id="userEmail">‚Äî</p>

          <div style="margin:12px 0">
            <div class="center flag">üáªüá¶</div>
            <p class="center">Bandeiras coletadas: <strong id="flagCount">0</strong></p>
            <p class="center small muted" id="nextMsg">Pr√≥xima coleta: dispon√≠vel</p>
            <div class="center" style="margin-top:10px">
              <button id="btnCollect">Coletar bandeira</button>
            </div>
            <div class="center" style="margin-top:10px">
              <button id="btnLogout" class="ghost" style="background:transparent;color:#c0392b;border:1px solid rgba(0,0,0,.06)">Sair</button>
            </div>
          </div>
        </div>

        <hr style="margin:12px 0;border:none;border-top:1px solid rgba(0,0,0,.04)" />
        <p class="small muted">Dica: o sistema salva suas bandeiras na sua conta do Firebase. S√≥ voc√™ v√™ seu progresso.</p>
      </div>

      <!-- MAIN CONTENT -->
      <div>
        <section class="card">
          <h2>Portal do Cat√≥lico ‚Äî Guia e Recursos</h2>
          <p class="small muted">Se√ß√µes: Ora√ß√µes, Santos, Curiosidades e Not√≠cias. Fa√ßa login para coletar bandeiras üáªüá¶ a cada 1 hora.</p>
        </section>
        <section class="card" style="margin-top:18px">
          <h2>Ora√ß√µes</h2>
          <div style="display:grid;gap:12px">
            <div>
              <strong>Pai Nosso</strong>
              <p class="small muted">Pai nosso, que estais nos c√©us, santificado seja o vosso nome...</p>
            </div>
            <div>
              <strong>Ave Maria</strong>
              <p class="small muted">Ave Maria, cheia de gra√ßa, o Senhor √© convosco...</p>
            </div>
          </div>
        </section>
            <section class="step"><h2>1. Comece com o desejo sincero de seguir a Cristo</h2><p>Entregar a vida e manter um desejo cont√≠nuo de crescer na f√© √© a base para os pr√≥ximos passos.</p></section>
    <section class="step"><h2>2. Participe da Missa regularmente</h2><p>Valorize a Eucaristia dominical e feriados, participando com aten√ß√£o e ora√ß√£o.</p></section>
    <section class="step"><h2>3. Receba os sacramentos: Batismo e Confirma√ß√£o</h2><p>Esses sacramentos fortalecem a f√© e a liga√ß√£o com a Igreja.</p></section>
    <section class="step"><h2>4. Fa√ßa a Primeira Eucaristia com rever√™ncia</h2><p>Preparar-se espiritualmente √© essencial para receber o Corpo de Cristo.</p></section>
    <section class="step"><h2>5. Confesse-se regularmente</h2><p>O sacramento da Reconcilia√ß√£o ajuda a manter o cora√ß√£o puro e a alma em paz.</p></section>
    <section class="step"><h2>6. Ore diariamente</h2><p>Reserve momentos para ora√ß√£o pessoal, agradecimento e pedidos.</p></section>
    <section class="step"><h2>7. Leia a B√≠blia e medite</h2><p>Estude a Palavra de Deus para fortalecer a f√© e compreender os ensinamentos.</p></section>
    <section class="step"><h2>8. Estude a doutrina cat√≥lica</h2><p>Catecismo, documentos da Igreja e forma√ß√£o cont√≠nua ajudam na vida espiritual.</p></section>
    <section class="step"><h2>9. Ame o pr√≥ximo e pratique a caridade</h2><p>A caridade √© o cora√ß√£o da vida crist√£, demonstrando amor em a√ß√µes concretas.</p></section>
    <section class="step"><h2>10. Viva os Dez Mandamentos</h2><p>Seguir os mandamentos guia a vida moral e espiritual no dia a dia.</p></section>
    <section class="step"><h2>11. Honre a fam√≠lia e os mais velhos</h2><p>Respeito e cuidado com familiares fortalecem o v√≠nculo crist√£o.</p></section>
    <section class="step"><h2>12. Participe de grupos de ora√ß√£o</h2><p>Unir-se a comunidades fortalece a f√© e a amizade espiritual.</p></section>
    <section class="step"><h2>13. Respeite os ensinamentos do Papa e Bispos</h2><p>Eles guiam a Igreja e preservam a verdade da f√©.</p></section>
    <section class="step"><h2>14. Observe os dias santos e festas lit√∫rgicas</h2><p>Celebrar o calend√°rio lit√∫rgico aproxima o fiel de Deus e da Igreja.</p></section>
    <section class="step"><h2>15. Ajude na catequese ou ensino religioso</h2><p>Transmitir a f√© a outros √© um chamado de todos os cat√≥licos.</p></section>
    <section class="step"><h2>16. Pratique a humildade e o perd√£o</h2><p>O perd√£o fortalece o esp√≠rito e o relacionamento com Deus e os outros.</p></section>
    <section class="step"><h2>17. Fortale√ßa a f√© atrav√©s de devo√ß√µes</h2><p>Ros√°rio, novenas e pr√°ticas devocionais aprofundam a liga√ß√£o com Deus.</p></section>
    <section class="step"><h2>18. Confie na Provid√™ncia divina</h2><p>Entregue seus problemas a Deus com f√© e serenidade.</p></section>
    <section class="step"><h2>19. Sirva na Igreja</h2><p>Participar de minist√©rios e voluntariado √© forma de viver a f√© em a√ß√£o.</p></section>
    <section class="step"><h2>20. Pratique jejum e abstin√™ncia</h2><p>Observe os dias indicados para aprofundar a disciplina espiritual.</p></section>
    <section class="step"><h2>21. Estude a vida dos santos</h2><p>Inspire-se em exemplos de virtude e santidade para crescer na f√©.</p></section>
    <section class="step"><h2>22. Ensine a f√© aos jovens</h2><p>Transmitir a f√© √†s novas gera√ß√µes fortalece a Igreja e a sociedade.</p></section>
    <section class="step"><h2>23. Promova a paz e justi√ßa</h2><p>Viva valores crist√£os em sua comunidade e trabalho.</p></section>
    <section class="step"><h2>24. Participe de retiros espirituais</h2><p>Momentos de sil√™ncio e reflex√£o aprofundam a vida interior.</p></section>
    <section class="step"><h2>25. Desenvolva a vida interior</h2><p>Pratique ora√ß√£o contemplativa e medita√ß√£o para crescer espiritualmente.</p></section>
    <section class="step"><h2>26. Aprofunde-se na liturgia e m√∫sica sacra</h2><p>Valorize a beleza lit√∫rgica e os cantos sagrados da Igreja.</p></section>
    <section class="step"><h2>27. Apoie projetos sociais da Igreja</h2><p>Contribuir ajuda pessoas em situa√ß√£o de vulnerabilidade.</p></section>
    <section class="step"><h2>28. Cultive a gratid√£o e alegria crist√£</h2><p>Viva a f√© com entusiasmo e reconhecimento das b√™n√ß√£os.</p></section>
    <section class="step"><h2>29. Evite pecados e tenta√ß√µes</h2><p>Disciplina e ora√ß√£o ajudam a manter-se no caminho correto.</p></section>
    <section class="step"><h2>30. Fa√ßa exames de consci√™ncia di√°rios</h2><p>Reflita sobre atitudes e busque melhorar diariamente.</p></section>
    <section class="step"><h2>31. Participe da adora√ß√£o eucar√≠stica</h2><p>Momentos de contempla√ß√£o diante do Sant√≠ssimo fortalecem a f√©.</p></section>
    <section class="step"><h2>32. Pratique a caridade an√¥nima</h2><p>Atos discretos de amor ao pr√≥ximo agradam a Deus e fortalecem a comunidade.</p></section>
    <section class="step"><h2>33. Seja mission√°rio no seu ambiente</h2><p>Divulgue a f√© com palavras e atitudes em fam√≠lia, trabalho e sociedade.</p></section>
    <section class="step"><h2>34. Persevere na f√©</h2><p>Mantenha a f√© mesmo diante das dificuldades e prova√ß√µes.</p></section>
    <section class="step"><h2>35. Ame sempre a Deus sobre todas as coisas</h2><p>O amor a Deus √© o fundamento da vida crist√£ e de todos os outros passos.</p></section>
  </div>
  </article>
        <section class="card" style="margin-top:18px">
          <h2>Santos & Curiosidades</h2>
          <div style="display:grid;gap:12px">
            <div>
              <strong>S√£o Francisco de Assis</strong>
              <p class="small muted">Padroeiro dos animais. Exemplo de humildade.</p>
            </div>
            <div>
              <strong>Santa Rita de C√°ssia</strong>
              <p class="small muted">Conhecida como a santa das causas imposs√≠veis.</p>
            </div>
          </div>
        </section>

        <section class="card" style="margin-top:18px">
          <h2>Not√≠cias & Eventos</h2>
          <div style="display:grid;gap:12px">
            <div>
              <strong>Papa incentiva ora√ß√£o pela paz</strong>
              <p class="small muted">Mensagem recente incentiva a comunidade a rezar por reconcilia√ß√£o.</p>
            </div>
            <div>
              <strong>Campanha de caridade local</strong>
              <p class="small muted">Inscri√ß√µes abertas para voluntariado paroquial.</p>
            </div>
          </div>
        </section>
      </div>
    </div>
  </main>

  <footer>¬© 2025 Portal do Cat√≥lico ‚Ä¢ Feito com f√© üáªüá¶</footer>

  <!-- Firebase + l√≥gica -->
  <script type="module">
    /* ------------------------------
       IMPORTS (modular SDK)
       ------------------------------ */
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";
    import { getFirestore, doc, getDoc, setDoc, updateDoc } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

    /* ------------------------------------------------
       SUA CONFIG DO FIREBASE (VOC√ä J√Å MANDOU ESSA)
       ------------------------------------------------
       Vou usar exatamente a config que voc√™ enviou.
    */
    const firebaseConfig = {
      apiKey: "AIzaSyBs8B_Vsmx3pc3UnGDOiseSoeH0D4w2M0k",
      authDomain: "guia-do-catolico-fb-login.firebaseapp.com",
      projectId: "guia-do-catolico-fb-login",
      storageBucket: "guia-do-catolico-fb-login.firebasestorage.app",
      messagingSenderId: "607834445049",
      appId: "1:607834445049:web:1fc49e7107bd0a5c387e28",
      measurementId: "G-QP68MRVQ8B"
    };

    /* Inicializa Firebase */
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    /* ELEMENTOS */
    const emailEl = document.getElementById('email');
    const passwordEl = document.getElementById('password');
    const btnRegister = document.getElementById('btnRegister');
    const btnLogin = document.getElementById('btnLogin');
    const btnLogout = document.getElementById('btnLogout');
    const authMsg = document.getElementById('authMsg');

    const userBlock = document.getElementById('userBlock');
    const authBlock = document.getElementById('authBlock');
    const welcomeTitle = document.getElementById('welcomeTitle');
    const userEmailSpan = document.getElementById('userEmail');
    const flagCountEl = document.getElementById('flagCount');
    const nextMsg = document.getElementById('nextMsg');
    const btnCollect = document.getElementById('btnCollect');

    /* Estado local */
    let currentUser = null;
    let userData = { bandeiras: 0, ultimo: 0 }; // ultimo = timestamp da √∫ltima coleta (ms)

    /* Fun√ß√£o: carrega (ou cria) doc do usu√°rio no Firestore */
    async function ensureUserDoc(uid) {
      const ref = doc(db, "usuarios", uid);
      const snap = await getDoc(ref);
      if (!snap.exists()) {
        await setDoc(ref, { bandeiras: 0, ultimo: 0 });
        return { bandeiras: 0, ultimo: 0 };
      } else {
        return snap.data();
      }
    }

    /* Atualiza a UI do usu√°rio com os dados */
    function refreshUserUI() {
      flagCountEl.textContent = userData.bandeiras ?? 0;
      userEmailSpan.textContent = currentUser ? currentUser.email : '‚Äî';
      // Atualiza bot√£o de coletar com base no √∫ltimo
      const agora = Date.now();
      const diff = Math.max(0, 3600000 - (agora - (userData.ultimo || 0)));
      if (diff <= 0) {
        nextMsg.textContent = "Pr√≥xima coleta: dispon√≠vel";
        btnCollect.disabled = false;
      } else {
        const h = Math.floor(diff / 3600000);
        const m = Math.floor((diff % 3600000) / 60000);
        const s = Math.floor((diff % 60000) / 1000);
        nextMsg.textContent = `Pr√≥xima coleta: ${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
        btnCollect.disabled = true;
      }
    }

    /* Atualizador de timer a cada segundo (apenas UI) */
    setInterval(() => {
      if (currentUser) refreshUserUI();
    }, 1000);

    /* -------------------------
       AUTENTICA√á√ÉO: cadastro
       ------------------------- */
    btnRegister.addEventListener('click', async () => {
      authMsg.textContent = '';
      const email = emailEl.value.trim();
      const password = passwordEl.value;
      if (!email || !password) { authMsg.textContent = 'Preencha email e senha.'; return; }
      if (password.length < 6) { authMsg.textContent = 'Senha precisa ter ao menos 6 caracteres.'; return; }
      try {
        await createUserWithEmailAndPassword(auth, email, password);
        authMsg.textContent = 'Conta criada ‚Äî entrando...';
      } catch (err) {
        authMsg.textContent = 'Erro: ' + (err.message || err);
        console.error(err);
      }
    });

    /* -------------------------
       AUTENTICA√á√ÉO: login
       ------------------------- */
    btnLogin.addEventListener('click', async () => {
      authMsg.textContent = '';
      const email = emailEl.value.trim();
      const password = passwordEl.value;
      if (!email || !password) { authMsg.textContent = 'Preencha email e senha.'; return; }
      try {
        await signInWithEmailAndPassword(auth, email, password);
      } catch (err) {
        authMsg.textContent = 'Erro: ' + (err.message || err);
        console.error(err);
      }
    });

    /* -------------------------
       LOGOUT
       ------------------------- */
    btnLogout.addEventListener('click', async () => {
      await signOut(auth);
    });

    /* -------------------------
       ON AUTH STATE CHANGED
       ------------------------- */
    onAuthStateChanged(auth, async (user) => {
      currentUser = user;
      if (user) {
        // esconder auth, mostrar user
        authBlock.style.display = 'none';
        userBlock.style.display = 'block';
        // carrega doc do user
        try {
          userData = await ensureUserDoc(user.uid);
        } catch (err) {
          console.error('Erro ao carregar doc do usu√°rio:', err);
          userData = { bandeiras: 0, ultimo: 0 };
        }
        refreshUserUI();
      } else {
        // logout UI
        authBlock.style.display = 'block';
        userBlock.style.display = 'none';
        authMsg.textContent = '';
      }
    });

    /* -------------------------
       COLETAR: l√≥gica 1h e salvar no Firestore
       ------------------------- */
    btnCollect.addEventListener('click', async () => {
      if (!currentUser) { alert('Fa√ßa login para coletar.'); return; }
      const agora = Date.now();
      const ultimo = userData.ultimo || 0;
      if (agora - ultimo < 3600000) {
        const faltam = 3600000 - (agora - ultimo);
        const m = Math.floor(faltam / 60000);
        const s = Math.floor((faltam % 60000) / 1000);
        alert(`Ainda n√£o passou 1 hora. Aguarde ${m}m ${s}s.`);
        return;
      }
      // incrementar local e no Firestore
      userData.bandeiras = (userData.bandeiras || 0) + 1;
      userData.ultimo = agora;
      // atualizar UI imediatamente
      refreshUserUI();
      // salva no Firestore
      try {
        const ref = doc(db, 'usuarios', currentUser.uid);
        await updateDoc(ref, { bandeiras: userData.bandeiras, ultimo: userData.ultimo });
        alert('Voc√™ coletou uma bandeira üáªüá¶!');
      } catch (err) {
        // se update falhar (por ex. doc n√£o existir), usa setDoc
        try {
          const ref = doc(db, 'usuarios', currentUser.uid);
          await setDoc(ref, { bandeiras: userData.bandeiras, ultimo: userData.ultimo }, { merge: true });
          alert('Voc√™ coletou uma bandeira üáªüá¶!');
        } catch (e2) {
          console.error('Erro salvando bandeira:', e2);
          alert('Erro ao salvar. Verifique o console e regras do Firestore.');
        }
      }
    });

    /* -------------------------
       Observa√ß√£o sobre regras Firestore
       ------------------------- */
    // Se voc√™ testar e der erro de permiss√£o (permission-denied), abra o console do Firebase:
    // Firestore ‚Üí Regras e, temporariamente para testes, use:
    // service cloud.firestore {
    //   match /databases/{database}/documents {
    //     match /{document=**} {
    //       allow read, write: if request.auth != null;
    //     }
    //   }
    // }
    // Isso permite somente usu√°rios autenticados a ler/gravar ‚Äî seguro para testes.
  </script>
</body>
                </html>
